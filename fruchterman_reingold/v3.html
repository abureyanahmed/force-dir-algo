<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FR Graph: Path3 vs Cycle3</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 10px;
    }
    #controls {
      margin-bottom: 10px;
    }
    canvas {
      background: white;
      border: 1px solid #ccc;
      display: block;
    }
  </style>
</head>
<body>

<div id="controls">
  <label>
    Graph type:
    <select id="graphType">
      <option value="path3">path3</option>
      <option value="cycle3">cycle3</option>
    </select>
  </label>
  <button id="runBtn">Run</button>
</div>

<canvas id="graph" width="800" height="600"></canvas>

<script>
const width = 800;
const height = 600;

const canvas = document.getElementById("graph");
const ctx = canvas.getContext("2d");

let nodes = [];
let links = [];

const area = width * height;
let k;
let temperature;
const cooling = 0.95;

function createNodes(n = 3) {
  nodes = [];
  for (let i = 0; i < n; i++) {
    nodes.push({
      id: i,
      x: Math.random() * width,
      y: Math.random() * height,
      vx: 0,
      vy: 0
    });
  }
  k = Math.sqrt(area / nodes.length);
  temperature = width / 10;
}

function createLinks(type) {
  links = [];

  if (type === "path3") {
    // 3 vertices → 2 edges
    links.push({ source: 0, target: 1 });
    links.push({ source: 1, target: 2 });
  }

  if (type === "cycle3") {
    // 3 vertices → 3 edges
    links.push({ source: 0, target: 1 });
    links.push({ source: 1, target: 2 });
    links.push({ source: 2, target: 0 });
  }
}

function repulsiveForce(d) {
  return (k * k) / d;
}

function attractiveForce(d) {
  return (d * d) / k;
}

function step() {
  // reset forces
  for (const v of nodes) {
    v.vx = 0;
    v.vy = 0;
  }

  // repulsion
  for (let i = 0; i < nodes.length; i++) {
    for (let j = i + 1; j < nodes.length; j++) {
      const v = nodes[i];
      const u = nodes[j];

      let dx = v.x - u.x;
      let dy = v.y - u.y;
      let dist = Math.hypot(dx, dy) || 0.01;

      const f = repulsiveForce(dist);
      dx /= dist;
      dy /= dist;

      v.vx += dx * f;
      v.vy += dy * f;
      u.vx -= dx * f;
      u.vy -= dy * f;
    }
  }

  // attraction
  for (const e of links) {
    const v = nodes[e.source];
    const u = nodes[e.target];

    let dx = v.x - u.x;
    let dy = v.y - u.y;
    let dist = Math.hypot(dx, dy) || 0.01;

    const f = attractiveForce(dist);
    dx /= dist;
    dy /= dist;

    v.vx -= dx * f;
    v.vy -= dy * f;
    u.vx += dx * f;
    u.vy += dy * f;
  }

  // move
  for (const v of nodes) {
    const disp = Math.hypot(v.vx, v.vy) || 0.01;
    v.x += (v.vx / disp) * Math.min(disp, temperature);
    v.y += (v.vy / disp) * Math.min(disp, temperature);

    v.x = Math.min(width, Math.max(0, v.x));
    v.y = Math.min(height, Math.max(0, v.y));
  }

  temperature *= cooling;
}

function draw() {
  ctx.clearRect(0, 0, width, height);

  // links
  ctx.strokeStyle = "#aaa";
  ctx.beginPath();
  for (const e of links) {
    const s = nodes[e.source];
    const t = nodes[e.target];
    ctx.moveTo(s.x, s.y);
    ctx.lineTo(t.x, t.y);
  }
  ctx.stroke();

  // nodes
  ctx.fillStyle = "#4682b4";
  for (const v of nodes) {
    ctx.beginPath();
    ctx.arc(v.x, v.y, 6, 0, Math.PI * 2);
    ctx.fill();
  }
}

function animate() {
  step();
  draw();
  requestAnimationFrame(animate);
}

// UI
document.getElementById("runBtn").addEventListener("click", () => {
  const type = document.getElementById("graphType").value;
  createNodes(3);
  createLinks(type);
});

// initial state
createNodes(3);
createLinks("path3");
animate();
</script>

</body>
</html>
